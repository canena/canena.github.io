<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <!-- [docs]
        Welcome to our not-so-fancy inline tutorial. If you read this it's probably
        safe to assume you are interested in such things so have fun following our
        thoughts. This is *just* a content page, for more information on the overall
        approach of the site visit /home.
    -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Martin Feineis">
    <meta name="creator" content="Canena">
    <meta name="description" content="A blog about life">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'sha256-YzxQZnYzEzF+cXKWurXLJQfpy1c+ScGqPeldlHJNbDk=' 'sha256-vvt4KWwuNr51XfE5m+hzeNEGhiOfZzG97ccfqGsPwvE='; style-src 'self' 'sha256-uD7ie2YbTG1HzuFUnelB4zEhDlR5sSiroNrWljEstxs='; connect-src 'self' https://api.github.com/repos/canena/canena.github.io/issues/18/comments ">
    <title>An Elm To The Past &bullet; CANENA</title>
    <script>
/*! hubjs stub */
(function(w,t){"use strict";function a(o,x){(o._||(o._=[])).push(x)}
function s(){return function f(){a(f,t.call(arguments))}}
w.Hub=w.Hub||{config:s(),log:s(),use:s()};}(self,[].slice))
    </script>
    <link href="/cdn/common.dev.css" rel="stylesheet" type="text/css">
    <script async type="module" src="/_includes/include.js"></script>
</head>
<body>
    <script defer src="/cdn/config.js"></script>
    <script defer type="module" src="/cdn/ca/requires.js"></script>
    <script defer type="module" src="/cdn/site.js"></script>

    <ca-requires elements="fx-toggle gh-comments logo-switcher reading-meta reading-progress scroll-behavior"></ca-requires>
    <ca-scroll-behavior></ca-scroll-behavior>

    <header {cover} class="bg-sky-400 h-golden">
        <nav>
            <a {box} href="/" title="Return to home page">
                <img logo class="invert" src="/cdn/canena.svg" width="95" height="30" alt="CANENA">
            </a>
        </nav>
        <div {center} {cover.art}>
            <div {box} class="backdrop-blur text-white">
                <h1 class="capitalize">An Elm To The Past</h1>
                <h2 class="capitalize italic">This blog post compiles the advice I posted in a discussion on Elm Discourse on support of Elm for older browsers</h2>
                <div class="flex gap-2">
                    <p class="whitespace-nowrap">2018-02-24</p>
                    <ca-reading-meta class="italic"></ca-reading-meta>
                </div>
                <ul class="list-none flex gap-2">
                    <li><a class="tag" href="/tags#elm">elm</a></li>
                    <li><a class="tag" href="/tags#legacy-code">legacy-code</a></li>
                    <li><a class="tag" href="/tags#tech">tech</a></li>
                    <li><a class="tag" href="/tags#web">web</a></li>
                </ul>
            </div>
        </div>
    </header>

    <main>
        <div class="bg-gradient-subtle">
            <div {center} class="bg-default">
                <article {box}>

                    <p>This blog post compiles the advice I posted in
                    <a href="https://discourse.elm-lang.org/t/elm-support-for-older-browsers-ie-9-10/744/6" target="_blank" rel="noopener noreferrer">a discussion on Elm Discourse</a>
                    on support of Elm for older browsers and is pretty much reproduced verbatim, thanks to the power Markdown.</p>
                    <p>I've put all the information in here to good use so head to
                    <a href="https://github.com/mfeineis/elm-legacy-browser-setup" target="_blank" rel="noopener noreferrer">https://github.com/mfeineis/elm-legacy-browser-setup</a>
                    if you want to see some code right away. I even managed to bring support for IE8+, which I didn't expect, tbh.</p>
                    <h3>Original Post Gist</h3>
                    <p>"Is there an official list of supported browsers for Elm? If not, what is the oldest browser you've tested Elm against? Lastly, is there a way to make Elm work on at least IE9 and IE10?"</p>
                    <h3>TL;DR</h3>
                    <p>if you have a valid HTML5 doctype and the mentioned polyfills in place an Elm program should run without problems in IE9+, iff you don't have any other ancient JS lingering around the same page that messes with global variables.</p>
                    <h3>The Long Version</h3>
                    <p>The following are potential issues I've dealt with in the past with ancient JS engines. This is a quick run-down I compiled while looking through the generated code of one of my small Elm projects.</p>
                    <p>Low hanging fruit that is easily polyfillable, remember to include these <em>before</em> including your elmish JS:</p>
                    <ul class="list-disc list-inside">
                        <li><code>console.log</code> doesn't exist in IE if the devtools are not open so maybe include <a href="https://github.com/paulmillr/console-polyfill" target="_blank" rel="noopener noreferrer">a console polyfill</a> or write one yourself</li>
                        <li>IE lt 9 doesn't support <code>Array.prototype.indexOf()</code> -&gt; <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf" target="_blank" rel="noopener noreferrer">MDN polyfill</a></li>
                        <li><code>String.prototype.trim</code> is not supported in IE lt 9 so use another <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/trim" target="_blank" rel="noopener noreferrer">MDN polyfill</a> to support that</li>
                        <li><code>JSON.stringify/JSON.parse</code> are IE8+ -&gt; <a href="https://www.json.org/" target="_blank" rel="noopener noreferrer">www.json.org has you covered</a></li>
                    </ul>
                    <p>Potential show-stoppers for IE lt 9:</p>
                    <ul class="list-disc list-inside">
                        <li>IE lt 9 doesn't have the proper W3C event model so <code>event.stopPropagation</code>, <code>event.stopImmediatePropagation</code>, <code>event.preventDefault</code> might be problematic, I'm not sure whether this is polyfillable without patching the kernel JS dealing with events that comes with <code>elm-lang/virtual-dom</code></li>
                        <li>IE lt 9 doesn't support <code>EventTarget.addEventListener/EventTarget.removeEventListener</code></li>
                    </ul>
                    <p>Not sure but might be problematic:</p>
                    <ul class="list-disc list-inside">
                        <li>I'm not sure about keywords as labels, in my code there is a <code>get:</code> label in <code>_elm_lang$core$Dict$get</code>, that could be an issue in older browsers - <code>get</code> isn't a keyword but in ES5 is used to define a getter so I wouldn't put it beyond IE to make a fuss about that</li>
                        <li>I loosely remember <code>document.createDocumentFragment</code> only being IE8+ but MDN says IE supports it all the way</li>
                    </ul>
                    <p>Non-issues:</p>
                    <ul class="list-disc list-inside">
                        <li>the JS has a <code>setTimeout</code> powered fallback for <code>requestAnimationFrame</code> so a polyfill doesn't seem necessary after all</li>
                        <li><code>"use strict";</code> is IE8+ but falls back gracefully so that shouldn't be a problem</li>
                    </ul>
                    <p>Trivia:</p>
                    <p>The generated JS isn't that idiomatic especially with the usage of the curlies on the next line and the variable declarations that make the impression that JS has block scope where it actually has function scope. There are also a lot of unguarded <code>for (... in ...)</code> traversals that might throw off older IE, even more so if other JS lives on the same site that potentially modifies shared globals.</p>
                    <h3>General Advice:</h3>
                    <p>Don't trust IE :-), no, seriously, don't trust it. Microsoft did a good job in keeping most of the behavior of their old JScript engine versions in their compatibility mode, kudos to the team that had that miserable job on their plate. The problems arise with the combinatorial explosion of the various document modes and their interaction with the legacy engines that are being carried around since days of yore. Multiply that by the fact that an IE version potentially behaves different on every major windows version, times the supported architectures. To sum up: the engine recreation is pretty good but the host objects and especially the document models will haunt you forever. My advice for managment still stands: if even Microsoft isn't supporting IE lt 11, why should you? Usually numbers work better with management, so my anecdotal tally is</p>
                    <blockquote>
                    <p>1.5 * (time spent on all evergreen browsers combined) (lte) time spent on keeping IE supported</p>
                    </blockquote>
                    <p>, so go figure.</p>
                    <h3>EDIT</h3>
                    <p>I created a <a href="https://github.com/mfeineis/elm-legacy-browser-setup" target="_blank" rel="noopener noreferrer">small but useful example project</a>
                    based on the advice given in this article. The README should fill in the blanks.</p>

                </article>
            </div>

            <div {center} class="bg-default">
                <hr>
                <ca-gh-comments {box} issue="https://api.github.com/repos/canena/canena.github.io/issues/18">
                    <h4 comments-heading>Comments</h4>
                    <p>
                        The comments for this post are available on <a href="https://github.com/canena/canena.github.io/issues/18" target="_blank" rel="noopener noreferrer">this issue on GitHub</a>.
                        Feel free to engage in conversation over there.
                    </p>
                    <include-partial href="/_includes/comment-section.html"></include-partial>
                </ca-gh-comments>
            </div>

            <footer {center} {billboard}="dots" class="border-t">
                <nav class="px-2 pb-20">
                    <include-partial href="/_includes/footer-links.html"></include-partial>
                </nav>
            </footer>
        </div>
    </main>

    <nav class="floaty-nav | fixed bottom-0 w-full">
        <include-partial href="/_includes/floaty-nav-article.html"></include-partial>
        <include-partial href="/_includes/floaty-nav-body.html"></include-partial>
    </nav>

    <script defer src="/deps/hubjs/hub.dev.js"></script>
</body>
</html>
